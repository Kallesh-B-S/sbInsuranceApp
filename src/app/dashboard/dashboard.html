<div class="dashboard-wrapper">
  <main class="dashboard-grid">
    <header class="page-header">
      <div class="header-main">
        <h1 class="page-title">Policies</h1>

        <div class="filter-bar">
          <div class="search-input-group">
            <mat-icon>search</mat-icon>
            <input type="text" placeholder="Search by Plan..." (input)="applyFilter($event, 'plan')">
          </div>

          <div class="select-input-group">
            <mat-icon>filter_list</mat-icon>
            <select (change)="applyFilter($event, 'status')">
              <option value="">All Statuses</option>
              <option value="ACTIVE">Active</option>
              <option value="PENDING">Pending</option>
              <option value="EXPIRED">Expired</option>
            </select>
          </div>
        </div>
      </div>
    </header>

    <section class="glass-card">
      <div class="table-responsive-container">
        <table mat-table [dataSource]="filteredPolicies()" class="custom-table">

          <ng-container matColumnDef="policyNumber">
            <th mat-header-cell *matHeaderCellDef> ID </th>
            <td mat-cell *matCellDef="let p">
              <a [routerLink]="['/policy', p.policyNumber]" class="orange-link fw-bold">{{p.policyNumber}}</a>
            </td>
          </ng-container>

          <ng-container matColumnDef="policyName">
            <th mat-header-cell *matHeaderCellDef> Plan </th>
            <td mat-cell *matCellDef="let p"> {{p.policyName}} </td>
          </ng-container>

          <!-- <ng-container matColumnDef="automobileID">
            <th mat-header-cell *matHeaderCellDef> Auto ID </th>
            <td mat-cell *matCellDef="let p"> <span class="text-secondary">#{{p.automobileID}}</span> </td>
          </ng-container> -->

          <ng-container matColumnDef="premiumAmount">
            <th mat-header-cell *matHeaderCellDef> Premium </th>
            <td mat-cell *matCellDef="let p"> {{p.premiumAmount | currency}} </td>
          </ng-container>

          <ng-container matColumnDef="coverageAmount">
            <th mat-header-cell *matHeaderCellDef> Coverage </th>
            <td mat-cell *matCellDef="let p"> {{p.coverageAmount | currency}} </td>
          </ng-container>

          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef> Status </th>
            <td mat-cell *matCellDef="let p">
              <!-- <span class="badge badge-active">{{p.status}}</span> -->
              <span class="badge" [ngClass]="'badge-' + p.status.toLowerCase()">{{p.status}}</span>
            </td>
          </ng-container>

          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef class="text-right"> Actions </th>
            <td mat-cell *matCellDef="let p">
              <div class="action-cell-wrapper">
                <button mat-button class="view-claims-btn" [routerLink]="['/claims', p.id]">
                  <mat-icon>visibility</mat-icon>
                  <span>View Claims</span>
                </button>
                <button mat-button class="apply-claim-btn" (click)="openApplyClaimModal(p)">
                  <mat-icon>post_add</mat-icon>
                  <span>Apply Claim</span>
                </button>
                <button mat-button class="view-claims-btn" [routerLink]="['/policy/', p.policyNumber]">
                  <mat-icon>visibility</mat-icon>
                  <span>View Details</span>
                </button>
              </div>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="policyColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: policyColumns;"></tr>

          <tr class="mat-row no-data-row" *matNoDataRow>
            <td class="mat-cell text-center p-4" [attr.colspan]="policyColumns.length">
              <div class="no-data-content">
                <mat-icon style="font-size: 48px; height: 48px; width: 48px; color: #ccc;">search_off</mat-icon>
                <p>No policies found matching your criteria.</p>
              </div>
            </td>
          </tr>
        </table>
      </div>
    </section>
  </main>
</div>